#!/usr/bin/env bash
set -euo pipefail

image_name="${CLAUDE_CONTAINER_IMAGE:-claude-container:latest}"
git_creds_args=()
if [[ ! -z "${CLAUDE_GIT_PAT_PATH:-}" ]]; then
	echo "âœ… Using git pat from ${CLAUDE_GIT_PAT_PATH}"
	mount_path="$(realpath "${CLAUDE_GIT_PAT_PATH/#\~/$HOME}")"
	echo "$mount_path"
	git_creds_args=(-v "${mount_path}:/home/node/.git-credentials")
else
	echo "ðŸš« No git credentials available at \$CLAUDE_GIT_PAT_PATH"
fi

docker run --rm -it \
  -v "${HOME}/.claude:/home/node/.claude" \
  -v "${HOME}/.claude.json:/home/node/.claude.json" \
  "${git_creds_args[@]}" \
  -v "$(pwd)":/workarea \
  -w /workarea \
  "${image_name}" \
  "$@"

